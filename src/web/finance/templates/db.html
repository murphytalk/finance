{% extends "layout.html" %}
{% block head %}
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.11/css/jquery.dataTables.min.css" type="text/css" />
{% endblock %}
{% block content %}
<div class="row">
    <div class="col-md-12 top5 bottom5">
        <div class="btn-group">
            <button type="button" class="btn btn-primary" id="q">quote</button>
            <button type="button" class="btn btn-primary" id="t">transaction</button>
            <button type="button" class="btn btn-primary" id="x">xccy</button>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <table id="dbtable" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0">
            <thead></thead>
        </table>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.datatables.net/1.10.11/js/jquery.dataTables.min.js"></script>
<script>
    function clear_table() {
        if ($.fn.dataTable.isDataTable('#dbtable')) {
            table = $('#dbtable').DataTable();
            table.destroy();
            $('#dbtable tbody').remove();
        }
    }
    function build_header(headers) {
        var head = $("<thead>").append();
        var tr = $("<tr>");
        clear_table();
        $.each(headers, function (idx, h) {
            tr.append($("<th>").append(h));
        });
        head.append(tr);
        $("#dbtable thead").replaceWith(head);
    };
    function populdate_data(url) {
        $("#dbtable").DataTable({
            'ajax': url,
            "order": [[0, 'desc'], [1, 'asc']],
            'pageLength': 100
        });

    };
    $("#q").click(function () {
        build_header(['Date', 'Symbol', 'Price']);
        populdate_data("{{url_for('db_quote_json')}}");
    });
    $("#t").click(function () {
        build_header(['Date', 'Symbol', 'Type', 'Price','Shares','Fee']);
        populdate_data("{{url_for('db_trans_json')}}");
    });
    $("#x").click(function () {
        build_header(['Date', 'From', 'To','Rate']);
        populdate_data("{{url_for('db_xccy_json')}}");
    });
</script>
{% endblock %}
